= **5. Selecting Integration Style Between Web and API Services**

**Date:** 2025-12-11

== **Problem**

The OffroadCamping.Appointments platform consists of two independent services:  
- **OffroadCamping.Appointments.API** — exposes job operations  
- **OffroadCamping.Appointments.Web** — Blazor frontend consuming the API  

These services must exchange data efficiently. Traditional REST polling caused delays, unnecessary load, and poor UX for long-running job retrieval. We evaluated several integration styles: REST, gRPC, WebSockets, shared models, and message-based integration. Challenges included avoiding tight coupling, supporting browsers, and enabling real-time updates without complex infrastructure.

== **Decision**

We will use **REST over HTTP** for commands and queries, and **Server-Sent Events (SSE)** for real-time job retrieval.

Key points:  
- Web uses **typed HttpClient** for standard API calls.  
- API exposes **DTO-based REST endpoints** for job creation and status queries.  
- API exposes an **SSE endpoint** streaming job updates in real time.  
- Web listens to SSE using `EventSource` or Blazor streaming APIs.  
- Aspire service binding URIs (`https+http://apiservice`) provide service discovery.

== **Consequences**

**Positive:**  
- Real-time UI updates without polling  
- Simple, browser-native streaming (no WebSockets required)  
- Clear separation between UI and API  
- Efficient for long-running job processing  
- Fully compatible with Aspire orchestration

**Negative:**  
- SSE is one-way only (server → client)  
- Requires keeping long-lived HTTP connections open  

== **Alternatives Considered**

- **Polling** — inefficient and slow  
- **WebSockets** — more complex than needed  
- **gRPC** — not browser-friendly  
- **Shared domain models** — rejected to avoid coupling  

== **Outcome**

REST + SSE is the official integration style between Web and API services. All future real-time features should use SSE unless requirements change.
